### ãƒŒãƒ¼ãƒ©ãƒœã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåŸºç›¤ API ã‚’
### Java ã‹ã‚‰ Kotlin ã«ç§»è¡Œã—ã¦æ°—ã¥ã„ãŸ
### 3 ã¤ã®ãƒ¡ãƒªãƒƒãƒˆãƒ»ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ

<a href="https://twitter.com/kasecato" target="_blank"><img style="border-radius: 50% !important;" src="img/twitter.jpg" width="140px" alt="Keisuke KATO"></a>

### [Kotlin Fest 2018](https://kotlin.connpass.com/event/91666/)

2018/8/25 <a href="https://github.com/kasecato" target="_blank">@kasecato</a> from <a href="https://nulab-inc.com/">Nulab</a>



## ãƒŒãƒ¼ãƒ©ãƒœã§ã¯ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåŸºç›¤ã‚’ãƒªãƒ‡ã‚¶ã‚¤ãƒ³ä¸­
ã€Œãƒ¦ãƒ¼ã‚¶ä½“é¨“ã‚’æ”¹å–„ã—ãŸã„ã€

|                     | Before                               | After  |
|:--------------------|:-------------------------------------|:-------|
| ã‚µãƒ¼ãƒã‚µã‚¤ãƒ‰       | Java 8                               | Kotlin |
| ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ | Haxe<br/>Knockout.js<br/>Thymeleaf 3 | React  |



## ãªãœ Kotlin ï¼Ÿ
- ã‚¿ãƒ†ãƒã‚¨
    - ãƒ¢ãƒ€ãƒ³ãªè¨€èªã§ç”Ÿç”£æ€§ã‚’é«˜ã‚ãŸã„
- ãƒ›ãƒ³ãƒ
    - ã€ŒJavaã€ã¨ã„ã†ã ã‘ã§ä¸–é–“ã®ç›®ãŒâ€¦
        - ãƒŒãƒ¼ãƒ©ãƒœã«ã¯ Scala ã¨ Go ã®é–‹ç™ºè€…ãŒå¤šã„
        - ä¸–é–“ã® [Java dis](https://twitter.com/search?f=tweets&vertical=default&q=java%20%E3%83%AC%E3%82%AC%E3%82%B7%E3%83%BC) ã§ä¸‹ãŒã‚Šç¶šã‘ã‚‹é–‹ç™ºãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³
    - ã€Œå†æ§‹ç¯‰ãªã®ã«æ–°ã—ã„ã“ã¨ã«ã¯æŒ‘æˆ¦ã—ãªã„ã®ã‹ï¼Ÿã€ã¨ã„ã†è‘›è—¤
    - ã—ã‹ã—é›ãˆã‚‰ã‚ŒãŸè²´é‡ãªè³‡ç”£ãŒã‚ã‚‹ã®ã§ JVM ã¯æ¨ã¦ãŸããªã„



### ã€Kotlinã‚¤ãƒ³ãƒ»ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã€ã‚’èª­ã‚“ã 
<img  src="img/kotlin_in_action.jpg" width="380px">



## ã€Kotlinã‚¤ãƒ³ãƒ»ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã€ åºæ–‡

> Javaã®ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã¯JetBrainsã«ã¨ã£ã¦éå¸¸ã«è²´é‡ãªè³‡ç”£ã§ã‚ã‚Šã€ã“ã‚Œã‚’å¤±ã†ã“ã¨ã€ã‚ã‚‹ã„ã¯ç›¸äº’é‹ç”¨æ€§ã®å›°é›£ã•ã«ã‚ˆã£ã¦ä¾¡å€¤ã‚’ä¸‹ã’ã‚‹ã“ã¨ã¯å›é¿ã—ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ 

- åŒã˜èª²é¡Œè¨­å®šã‚’è§£æ±ºã—ãŸè¨€èªãŒã‚ã£ãŸï¼
- ã€Kotlinã‚¤ãƒ³ãƒ»ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã€ åºæ–‡ã«æ·±ãå…±æ„Ÿã—ãŸï¼



## 1 é€±é–“å¾Œ Java 8 ã‚’ Kotlin ã«å…¨ç§»è¡Œ



## ãƒ¡ãƒªãƒƒãƒˆ 1
## ã‚³ãƒ¼ãƒ‰è¡Œæ•°ãŒ -22% æ¸›å°‘

|            |      |  Java 8 | Kotlin | å¢—æ¸›ç‡ |
|:-----------|:-----|--------:|-------:|-------:|
| ã‚³ãƒ¼ãƒ‰è¡Œæ•° | main | 10,228L | 7,958L |   -22% |
|            | test |  6,509L | 7,018L |    +7% |

- [Kotlin å…¬å¼ã§ã¯æ¦‚ç®—ã§ 40% å‰Šæ¸›å¯èƒ½](https://kotlinlang.org/docs/reference/faq.html#what-advantages-does-kotlin-give-me-over-the-java-programming-language)
- [ãƒ•ãƒ©ãƒ³ã‚¹ NPO ã®é–‹ç™ºäº‹ä¾‹ã§ã‚‚ 1 ä¸‡è¡Œ ãŒ 8 åƒè¡Œã«](https://blog.ninja-squad.com/2018/05/22/kotlin-migration/)



## ãªãœã‚³ãƒ¼ãƒ‰è¡Œæ•°ãŒ 22% ã‚‚æ¸›å°‘?
- Kotlin ã¯ç°¡æ½”
    - ç‰¹ã«ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³æ“ä½œãŒç´ æ™´ã‚‰ã—ã„

```java
// Java
final List<Integer> accountIds = accounts.stream()
        .map(Account::getId)
        .collect(Collectors.toList());
```

```kotlin
// Kotlin
val accountIds = accounts.map { it.id }

// ãƒ¡ãƒ³ãƒå‚ç…§ã‚‚ã‚ã‚‹; map(Account::getId)
// é…å»¶ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚‚ã‚ã‚‹; asSequence() ã‚’ä½¿ç”¨
```



- Spring ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³

```java
// Java
@Service
public class DbAccountService implements AccountService {

	private final RiskAssessor riskAssessor;

	public DbAccountService(final RiskAssessor riskAssessor) {
		this.riskAssessor = riskAssessor;
	}

}
```

```kotlin
// Kotlin
@Service
class DbAccountService (private val RiskAssessor riskAssessor): AccountService {

}

// ãƒ—ãƒ©ã‚¤ãƒãƒª ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§åˆæœŸåŒ–ã•ã‚ŒãŸãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚‚å®šç¾©å¯èƒ½
```



## ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ 1
## ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚é–“ãŒ 2 ç§’å¢—åŠ 

|                |      | Java 8 | Kotlin | å¢—æ¸›ç‡ |
|:---------------|:-----|-------:|-------:|-------:|
| ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚é–“ | main |   5.5s |   7.6s |   +70% |
|                | test |   5.0s |   8.9s |   +78% |

- ã€Œ2ç§’ã€æ°—ã«ã—ã¾ã™ã‹ï¼Ÿ
- ã‚³ãƒ¼ãƒ‰è¡Œæ•°ãŒå¢—ãˆã‚Œã°ã‚‚ã£ã¨é…ããªã‚‹ã®ã§ã¯ï¼Ÿ
- Scala ã‚ˆã‚Šé€Ÿã‘ã‚Œã°(ry



## ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ 2
## 366 å€‹ã®ãƒ†ã‚¹ãƒˆæ™‚é–“ãŒ 13 ç§’å¢—åŠ 

|          |      | Java 8 | Kotlin | å¢—æ¸›ç‡ |
|:---------|:-----|-------:|-------:|-------:|
| å®Ÿè¡Œæ™‚é–“ | test |  46.5s |  59.5s |   +28% |

- [ã€ŒKotlinã®éš ã‚ŒãŸã‚³ã‚¹ãƒˆã«ã¤ã„ã¦ã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã€](https://postd.cc/kotlinshiddencosts-benchmarks/)
    - Kotlin ãŒé«˜é€Ÿ: ãƒ©ãƒ ãƒ€å¼ï¼Œã‚³ãƒ³ãƒ‘ãƒ‹ã‚ªãƒ³ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼Œãƒ­ãƒ¼ã‚«ãƒ«é–¢æ•°ï¼Œnull å®‰å…¨
    - Kotlin ãŒä½é€Ÿ: å¯å¤‰å¼•æ•°ï¼‹ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰æ¼”ç®—å­ï¼Œãƒ‡ãƒªã‚²ãƒ¼ãƒˆ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£



## ã¾ã¨ã‚
[Nulab Apps ãƒãƒ¼ãƒ ã§ã¯ Kotliner ã‚’å¾…ã£ã¦ã„ã¾ã™ï¼](https://www.wantedly.com/projects/75901)



## ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸ ğŸ™‡â€
<a href="https://nulab-inc.com/"><img src="img/nulab_logo_color.svg" width="300px" alt="nulab" /></a>
### by [Nulab Apps ãƒãƒ¼ãƒ ](https://nulab-inc.com/ja/about/careers/nulab-apps-developer/)
## Kotlin ã‹ã‚ã„ã„ï¼(Â´Ğ”ï½€)(Â´Ğ”ï½€)



## ãƒ“ãƒ«ãƒ‰ç’°å¢ƒ
- MacBook Pro (15-inch, 2016)
- Processor: Intel Core i7 2.9 GHz
- Memory: 16GB 2133 MHz LPDDR3
- Java HotSpot(TM) 64-Bit Server VM (build 25.171-b11, mixed mode)
- Kotlin version 1.2.51-release-125 (JRE 1.8.0_171-b11)
- æ¨™æœ¬æ•°: 5 (90 ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«å€¤)
- Clean & Build
    - $./gradlew :kotlinProj:clean build --profile
